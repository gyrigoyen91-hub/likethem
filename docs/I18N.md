# Internationalization (i18n) Guide

LikeThem uses a lightweight i18n system with Spanish (es) as the default language and English (en) as an optional language.

## Architecture

### Translation Files
- `locales/es/common.json` - Spanish translations (default)
- `locales/en/common.json` - English translations

### Core Utilities
- `lib/i18n/getLocale.ts` - Server-side locale detection from cookies
- `lib/i18n/t.ts` - Server-safe translation function
- `hooks/useT.ts` - Client-side translation hook
- `components/i18n/I18nProvider.tsx` - Client context provider for locale state
- `components/i18n/LanguageSwitcher.tsx` - Language switcher component

### API Routes
- `POST /api/i18n/locale` - Set locale cookie
- `GET /api/i18n/locale` - Get current locale

## Usage

### Server Components

```typescript
import { getLocale } from '@/lib/i18n/getLocale'
import { t } from '@/lib/i18n/t'

export default async function MyPage() {
  const locale = await getLocale()
  
  return (
    <h1>{t(locale, 'nav.dress')}</h1>
  )
}
```

### Client Components

```typescript
'use client'
import { useT } from '@/hooks/useT'

export default function MyComponent() {
  const t = useT()
  
  return (
    <h1>{t('nav.dress')}</h1>
  )
}
```

### String Interpolation

```typescript
// Translation file:
{
  "curator.noActiveDropDesc": "{name} doesn't have an active drop right now."
}

// Usage:
t(locale, 'curator.noActiveDropDesc', { name: curatorName })
```

## Adding New Translation Keys

1. Add the key to both `locales/es/common.json` and `locales/en/common.json`
2. Use dot notation for namespacing: `section.subsection.key`
3. Keep keys descriptive and consistent

### Naming Convention

- `nav.*` - Navigation items
- `auth.*` - Authentication
- `user.*` - User menu items
- `explore.*` - Explore/Discover page
- `curator.*` - Curator pages
- `product.*` - Product pages
- `access.*` - Access modal
- `sell.*` - Sell/Apply page
- `common.*` - Common UI strings

## Language Switcher

The language switcher is located in the Header component. It:
- Shows current locale (ES/EN)
- Persists selection in cookie (`likethem_locale`)
- Refreshes server components on change
- Works across all pages

## Locale Persistence

- Stored in cookie: `likethem_locale=es|en`
- Cookie expires in 1 year
- Default: Spanish (es) for new users
- Accessible from both server and client

## Development

Missing translation keys are logged as warnings in development mode:
```
[i18n] Missing translation key: nav.newFeature for locale: es
```

## Best Practices

1. **Never translate user-generated content** (curator names, bios, product titles)
2. **Use parameter interpolation** for dynamic values (e.g., `{name}`)
3. **Keep translations natural** - Spanish should feel premium, not literal
4. **Test both languages** after adding new UI strings
5. **Use TypeScript** - Translation keys are type-checked

## Troubleshooting

### Translation not showing
- Check the key exists in both translation files
- Verify locale is being read correctly (check cookie)
- Ensure component is using correct hook (`useT` for client, `t(locale, key)` for server)

### Build errors
- Ensure `getLocale()` is only called in server components
- Don't import `next/headers` in client components
- Use `getLocaleFromCookie()` for client-side locale reading
